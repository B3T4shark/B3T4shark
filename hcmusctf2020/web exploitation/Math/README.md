## âš¡ [Math](https://ctf.hcmus.edu.vn/challenges#Quelcome)

[![df](https://img.shields.io/badge/B3T4-shark-brightgreen.svg)](https://img.shields.io/badge/B3T4-shark-brightgreen.svg)
[![df](https://img.shields.io/badge/member-BHD233-brightgreen.svg)](https://img.shields.io/badge/member-BHD233-brightgreen.svg)
[![df](https://img.shields.io/badge/116-pts-brightgreen.svg)](https://img.shields.io/badge/116-pts-brightgreen.svg)


TÃ¡c giáº£: `tunt` `Glutamo Team`



Tags: `web exploitation` 


### Challenge Description

Äá» bÃ i cho má»™t Ä‘Æ°á»ng link trang web vá»›i vá»›i má»™t Ä‘á»‘ng phÃ©p toÃ¡n mÃ  chá»‰ cÃ³ má»™t phÃ©p toÃ¡n Ä‘Ãºng vÃ  yÃªu cáº§u nháº­p káº¿t quáº£.

http://35.187.250.39:8080/

### Summary
Sau má»™t lÃºc tÃ¬m hiá»ƒu thÃ¬ ta nháº­n ra quy luáº­t lÃ  chá»n phÃ©p toÃ¡n cÃ³ Ä‘á»™ dÃ i lá»›n nháº¥t vÃ  nháº­p kÃªt quáº£ phÃ©p toÃ¡n Ä‘Ã³ (giá»‘ng nguyÃªn lÃ½ chá»n cÃ¢u dÃ i nháº¥t cá»§a tráº¯c nghiá»‡m).

Sau khi biáº¿t quy luáº­t vÃ  thá»­ tay Ä‘Ãºng tá»›i 50 láº§n nhÆ°ng váº«n khÃ´ng ra flag, váº­y lÃ  pháº£i báº¯t tay vÃ o code chá»© khÃ´ng thá»ƒ lÃ m báº±ng tay thÃªm ná»¯a.

Sau khi phÃ¢n tÃ­ch gÃ³i tin, ta nháº­n ra cáº§n gá»­i gÃ³i get vá»›i Cookie vÃ  1 biáº¿n result. Thá»­ báº±ng postman vá»›i cookie láº¥y Ä‘Æ°á»£c tá»« gÃ³i Ä‘Ã³ luÃ´n vÃ  ta tháº¥y cÃ³ hiá»‡u quáº£. 

Viá»‡c cáº§n lÃ m bÃ¢y giá» Ä‘Æ¡n giáº£n lÃ  chá»n phÃ©p toÃ¡n, tÃ­nh vÃ  gá»­i káº¿t quáº£ Ä‘i.

Sau má»™t há»“i tÃ¬m kiáº¿m thÃ¬ Ä‘Ã£ phÃ¡t hiá»‡n ra API Ä‘á»ƒ thá»±c hiá»‡n tÃ­nh toÃ¡n: https://api.mathjs.org

Váº­y ta báº¯t tay vÃ o code (sá»­ dá»¥ng java):

```java
class Test {
    public static void main(String[ ] args) {
        String re = "0";
        
        while (true) {
            OkHttpClient client = new OkHttpClient().newBuilder().build();
            MediaType mediaType = MediaType.parse("text/plain");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                                    .addFormDataPart("result", re)
                                    .build();
            Request request = new Request.Builder()
                              .url("http://35.187.250.39:8080/index.php?result=6231")
                              .method("POST", body)
                              .addHeader("Cookie", "PHPSESSID=pjbom1pvbijp19rc24qfvdad54")
                              .build();
            Response response = client.newCall(request).execute();
            
            String str = response.body().string();
            
            if (str.indexOf("HCMUS-CTF") >= 0) {
                System.out.println(str);
                break;
            }
            
            String[] strs = str.split("<br>");
            
            List<String> calcs = new ArrayList<String>(); 
            
            for(String g : strs){
                String[] h = g.split(" ");
                
                String calc = h[0];
                for (String f : h) {
                    if (f.length() > calc.length()) {
                        calc = f;
                    }
                }
                
                calcs.add(calc);
            }
            
            String trueCalc = calcs[0];
            for (String calc : calcs) {
                if (calc[i].length() > trueCalc.length()){
                    trueCalc = calc[i];
                }
            }
            
            client = new OkHttpClient().newBuilder()
              .build();
            request = new Request.Builder()
              .url("https://api.mathjs.org/v4/?expr=" + trueCalc + "&precision=0")
              .method("GET", null)
              .addHeader("Content-Type", "application/json")
              .build();
            response = client.newCall(request).execute();
            
            String result = response.body().string();
            
            re = result;
        }
    }
}
```

ðŸ“« Flag: **`HCMUS-CTF{1+2_3_32_1_H0w_d0_u_4Ut0?}`**

---
*[Back to table of contents](../README.md)*
